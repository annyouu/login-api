# API仕様書
ログイン認証APIでのエンドポイント

- POST/register：新規ユーザーを登録する
- POST/login：ログイン
- GET/users/{user_id}：個別のユーザー情報を取得する。

今回は、あくまで勉強のためJWTを使った実装をしてみます。
JWTは必須ではないです。

# JWT仕様
- ペイロード：`{ "username": "user1", "exp": <期限> }`
    - username：ログインしたユーザーの名前
    - 保存場所：Cookie(XSS対策必須)
    - 有効期限：5分

# DB設計
usersテーブル

- id：integer
- username：text
- password_hash：text

# アーキテクチャの概要
クリーンアーキテクチャを採用。
ただクリーンアーキテクチャを使って終わりではなく、変更や拡張をしてみることによって利点を体系的に学ぶ。
また、他の人の実装も見て、自分とどう違っているのかを知ることも目的とする。

- 注意：実務面では、この規模に対して使うメリットはほぼないです。ログイン機能くらいは一つの機能としてディレクトリでまとめたほうがわかりやすいです。この小規模の機能で層を細かく分けてしまうと、むしろ構造が複雑化して開発・保守のコストが増えてしまう可能性があります。
しかし今回は、あくまで学習目的であり、クリーンアーキテクチャの強みである
- 「拡張性のしやすさ」
を特に体験するために、あえて使っていることはご留意ください。

## 各層の役割
- controller：HTTPリクエスト/レスポンスの受け取りと返却のみを役割とする。
- domain(ビジネスモデル)：アプリのドメイン知識を定義する層。
- usecase：アプリの具体的な機能のみを記述する層。
- repository：DBの永続化の操作を抽象化することや永続化処理(DBの処理)を記載する層。
- infrastructure：DB接続、JWT発行、外部APIの実装。本件のビジネスモデルには関係ない処理をまとめた層。

ここで2点について、
- domain層のドメイン知識ってなんや？
- repository層とinfrastructure層の状況に応じて、永続化の処理を分けるべきかのかがわからない。
repositoryが、DB永続化処理の抽象化のみでinfrastructureは、その実機能の実装として完全に分割すべきか？
それとも永続化の抽象化、実装を全てrepositoryに持たせて、infrastructureをDB接続という形で分けた方がいいのか？
自分的には前者。なぜなら、永続化処理を一つにまとめた方が何をやっているのかがより明確になると思ったため。
他の考慮すべきことがあるのだろうか？

# 11月18日 追記
どうやら、repositoryには抽象化したものだけを持たせて、infrastructureには、具体に実装を持たせるのがスタンダートみたいです。

## ドメイン知識とは
ドメインは、アプリケーションが解決する対象の問題領域のこと。つまり、アプリが、問題解決をするためのルールの関する定義のことをドメインと呼んでいる。
ドメイン知識は、問題領域に関する知識やルールのこと。

